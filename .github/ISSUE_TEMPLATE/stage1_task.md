---
name: ステージ1タスク
about: ステージ1（基本UDPチャット）の実装タスク
title: '[STAGE1] '
labels: ['task', 'stage-1']
assignees: ''
---

## 📋 タスク概要
**タスク番号**: [例: 1, 2, 3]
**タスク名**: [例: 基本UDPサーバの実装]

## 🎯 実装内容
<!-- ステージ1固有の実装内容を詳しく説明してください -->

### 主要な実装項目
- [ ] UDPソケットの作成と設定
- [ ] メッセージ受信ループの実装
- [ ] プロトコル解析の統合
- [ ] エラーハンドリングの実装

## 📝 関連要件
<!-- ステージ1の要件を記載 -->
- 要件1.1: サーバがCLIで起動される
- 要件1.2: サーバがオフラインの場合、チャットサービス全体が停止
- 要件1.3: UDPネットワークソケットを使用してクライアントとの通信を行う

## 🔧 技術仕様

### UDPメッセージプロトコル
```
[usernamelen: 1byte][username: variable][message: variable]
最大サイズ: 4096 bytes
エンコーディング: UTF-8
```

### パフォーマンス要件
- [ ] 処理速度: 10,000+ packets/second
- [ ] 同時接続数: 1,000+ connections
- [ ] メモリ使用量: <100MB (1000接続時)
- [ ] レスポンス時間: <10ms (ローカル環境)

## 🏗️ 実装アプローチ

### 主要クラス・関数
- `UdpServer`: メインサーバクラス
- `start()`: サーバ起動
- `stop()`: サーバ停止
- `handleMessage()`: メッセージ処理

### ファイル構成
```
src/
├── Server/
│   └── UdpServer.php      # Real-time message handling
├── Client/
│   └── CliClient.php      # CLI chat client
├── Common/
│   ├── Protocol/          # Message format handlers
│   ├── Utils/             # Shared utilities
│   └── Models/            # Data structures
```

## 🧪 テスト計画

### 単体テスト
- [ ] 正常なメッセージの解析テスト
- [ ] 最大サイズメッセージのテスト
- [ ] UTF-8文字のテスト
- [ ] エラーケースのテスト

### 統合テスト
- [ ] サーバ起動・停止テスト
- [ ] クライアント接続テスト
- [ ] メッセージ送受信テスト
- [ ] 複数クライアント同時接続テスト

## ✅ 完了基準
- [ ] UDPサーバが正常に起動・停止する
- [ ] クライアントからの接続を受け付けることができる
- [ ] メッセージプロトコルに従った解析ができる
- [ ] 複数クライアントとの同時通信ができる
- [ ] 全てのテストが通過している
- [ ] コードレビューが完了している
- [ ] ドキュメントが更新されている

## 🏷️ 固定ラベル
この issue には以下のラベルが自動で付与されます:
- `task`: 実装タスク
- `stage-1`: ステージ1関連

### 追加ラベル（該当するものを選択）
- [ ] `server`: サーバ関連
- [ ] `client`: クライアント関連
- [ ] `protocol`: プロトコル関連
- [ ] `priority-high`: 高優先度
- [ ] `priority-medium`: 中優先度
- [ ] `priority-low`: 低優先度

## 📊 見積もり
**予想作業時間**: [例: 4-8時間]
**難易度**: [例: 中〜高]

## 📚 参考資料
- [PHP Socket Documentation](https://www.php.net/manual/en/book.sockets.php)
- 設計書: `CLAUDE.md`
- プロジェクト要件: `README.md`

## 🔗 依存関係
**前提タスク**: [例: プロジェクト構造の設定が完了している必要がある]
**後続タスク**: [例: このタスク完了後にクライアント実装を開始可能]