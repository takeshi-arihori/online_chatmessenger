#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# PHP Code Style Check & Auto-fix
echo "ğŸ“ Checking and fixing PHP code style (PSR-12)..."
if ! composer cs:fix; then
    echo "âŒ PHP code style fix failed."
    exit 1
fi

# Run PHPUnit tests
echo "ğŸ§ª Running PHPUnit tests..."
if ! composer test; then
    echo "âŒ Tests failed."
    exit 1
fi

# Run PHPStan static analysis
echo "ğŸ” Running PHPStan static analysis..."
if ! composer analyse; then
    echo "âŒ Static analysis failed."
    exit 1
fi

echo "âœ… Pre-commit checks passed!"
